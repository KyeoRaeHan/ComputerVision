## CNN





#### 이미지 인식 방법

----------------

- CNN은 주로 이미지 인식 분야에서 사용되는 딥러닝 네트워크
- 이미지를 인식하는 알고리즘 종류는 다양하게 있지만 모두 CNN에 기반을 두고 있음



CNN 구조

컨볼루션 연산 뒤에 활성화 함수를 끼워 넣어야 한다.

컨볼루션 연산을 2개 이상 연속적으로 배치할 수 있음





#### convolution의 의미

------------------

딥러닝 관점

이미지에서 특징(feature)을 추출



수학적 관점

공학과 물리학에서 많이 사용되는 수학적 개념으로서

"두 함수중 하나를 반전, 이동시켜가며 나머지 함수와의 곱을 연이어 적분한다"



3개 키워드 이동, 곱, 적분을 기억하세요!



### Convolution  연산

------------------------------------

컨볼루션 계층에서는 **컨볼루션 연산**을 처리

컨볼루션 연산은 필터를 일정간격으로 이동해 가면서 입력데이터와 대응 원소(필터)간 곱셈을 실행한 후 총합을 구함

=> 연산결과를 **feature map**이라고 함



#### Convolution  연산

컨볼루션 연산은 필터를 일정간격으로 이동해 가면서 입력데이터와 대응 원소간 곱셈을 실행한 후 총합을 구함



### Feature Extraction

-------------

컨볼루션 연산을 하면 입력이미지의 특징(feature)을 다양하게 추출할 수 있음

컨볼루션 연산에 의해 추출된 다양한 feature들은 입력 이미지가 무엇인지를 판단하기 위한 그근거로 사용됨

컨볼루션 연산에 의해 추출된 특징을 마지막 계층인 fully connected layer에 입력시키면 입력 이미지의 클래스가 무엇인지 알 수 있게 됨.

=> 즉 fully connected layer는 추출된 특징들을 보고 클래스를 판단함.



### Pooling 연산

-----------------

컨볼루션 연산과 classification만으로도 분류 결과를 얻을 수 있으나

학습 연산량을 줄이기 위해 feature크기를 줄이는 과정을 추가함

즉, 컨볼루션 계층에서 추출된 feature map을 가로 세로 방향으로 축소하는 과정을 거치는데

이를 pooling 혹은 subsampling이라 함

pooling 연산에는 max pooling 과 average pooling이 있음(pooling연산은 convolution연산이 아님에 주의!)



#### pooling계층의 장점 및 특징

-------------

feature map 크기가 줄어들기 때문에 연산량을 줄일 수 있음

입력 데이터가 조금 변하더라도 풀링의 결과는 잘 변하지 않음



#### Fully connected Layer

-----------------

fully connected layer 역할

- 컨볼루션 계층 및 풀링 계층에 의해 추출된 피쳐맵을 사용하여 **최초 입력 이미지가 어떤 클래스에 속하는지**를 분류
- 클래스가 여러개인 경우 일반적으로 softmax 함수를 활성화 함수로 사용함
- 이진분류인 경우 sigmoid사용. 
- flatten() 함수 사용.





### 패딩(padding)

--------------------

패딩

- 컨볼루션 연산을 하기 전에 입력 데이터 주변을 특정값으로 채우는데 이를 패딩이라 함



패딩 필요성

- 출력크기를 조절할 때 사용. 즉 입력 데이터의 크기를 고정한 채로 다음 계층에 전달하기 위해 사용되는 기법

컨볼루션 연산을 계속 하다보면 어느 시점에는 크기가 1이 되어 더 이상 컨볼루션 연산을 할 수 없게되는 문제가 발생함

=> 4*4 입력데이터에 크기 1인 패딩을 적용하면 출력데이터가 그대로 유지됨



### 스트라이드(stride)

-----------------------------------------------

- 필터가 이동하는 간격을 스트라이드라고 함
- 스트라이드 값을 크게 할수록 출력 크기는 더 작아짐



### 가중치 vs 하이퍼파라미터

-------------------------------

가중치(weight) & 편향(bias)

- 딥러닝 알고리즘에 의해 자동적으로 최적값이 결정됨
- 딥러닝 알고리즘이 학습 데이터로부터 최적 가중치값을 자동으로 계산함



하이퍼파라미터

- 하이퍼파라미터는 뉴런수, 배치크기, 매개변수 갱신시의 학습률, epoch수
- cnn에서는 필터크기, 채널개수도 하이퍼파라미터
- 딥러닝 개발자가 최적값을 직접 설정







































